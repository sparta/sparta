SPARTA (7 Jan 2022)
################################################################################
# thermal gas in a 3d box with collisions
# particles reflect off global box boundaries
#
# Note:
#  - The "comm/sort” option to the “global” command is used to match MPI runs.
#  - The “twopass” option is used to match Kokkos runs.
# The "comm/sort" and "twopass" options should not be used for production runs.
################################################################################

seed	    	    12345
dimension   	    3
global              gridcut 1.0e-5 comm/sort yes

boundary	    rr rr rr

create_box  	    0 0.0001 0 0.0001 0 0.0001
Created orthogonal box = (0 0 0) to (0.0001 0.0001 0.0001)
create_grid 	    3 3 3
WARNING: Could not acquire nearby ghost cells b/c grid partition is not clumped (/ascldap/users/stamoor/sparta_stanmoore1/src/grid.cpp:410)
Created 27 child grid cells
  CPU time = 0.00108194 secs
  create/ghost percent = 85.8087 14.1913

balance_grid        rcb part
Balance grid migrated 24 cells
  CPU time = 0.000871181 secs
  reassign/sort/migrate/ghost percent = 69.0203 0.246305 13.191 17.5424

species		    n2.species N2
mixture		    air N2 vstream 0.0 0.0 0.0 temp 10000.0 trot 100.0

global              nrho 7.07043E22
global              fnum 7.07043E5

compute             coll_temp thermal/grid all all temp
collide		    vss air n2.vss relax variable T c_coll_temp

create_particles    air n 1000000 twopass
Created 1000000 particles
  CPU time = 0.239058 secs

stats		    1
compute             temp temp
compute             Ttrans reduce ave c_coll_temp[1]

compute             rot grid all all trot
compute             Trot reduce ave c_rot[1]

stats_style	    step cpu np nattempt ncoll c_Ttrans c_Trot

timestep 	    1.00E-9
run 		    200
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 26.1562 23.625 27
  grid      (ave,min,max) = 1.51379 1.51379 1.51379
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 27.6705 25.1392 28.5142
Step CPU Np Natt Ncoll c_Ttrans c_Trot 
       0            0  1000000        0        0    9994.2537      100.105 
       1    0.2609334  1000000   896600   300483    9795.1453    398.78965 
       2   0.52291298  1000000   896612   299203    9606.5461     681.6035 
       3    0.7838068  1000000   896627   297342    9428.8602    948.16557 
       4    1.0761719  1000000   896622   296113     9256.552    1206.5837 
       5    1.3373892  1000000   896619   293788    9095.2284    1448.5248 
       6    1.5974994  1000000   896627   293218    8942.8971    1677.0602 
       7    1.8564692  1000000   896625   291778    8797.9639    1894.5654 
       8    2.1527669  1000000   896620   289866    8659.3869    2102.4207 
       9    2.4117107  1000000   896630   289814    8528.7018    2298.4719 
      10    2.6698952  1000000   896622   288485    8406.5489    2481.7186 
      11    2.9475074  1000000   896622   286824    8287.0432    2661.0364 
      12    3.2178588  1000000   896632   286929    8176.5055    2826.8632 
      13    3.4752476  1000000   896625   285014    8070.5708    2985.7948 
      14    3.7476976  1000000   896637   284615    7971.4652    3134.4044 
      15    4.0370555  1000000   896634   283377    7875.2991    3278.6644 
      16    4.2922792  1000000   896629   282419    7784.5753    3414.8289 
      17    4.5492175  1000000   896645   282418    7698.9804    3543.2775 
      18    4.8042274  1000000   896644   280646    7617.3713    3665.5993 
      19    5.0916598  1000000   896635   279353    7538.8912    3783.3037 
      20    5.3472953  1000000   896633   279127    7465.7093    3893.0939 
      21    5.6029239  1000000   896638   279495    7397.5519    3995.2776 
      22    5.8578885  1000000   896648   278048    7329.7045    4097.0708 
      23    6.1652935  1000000   896645   277627     7266.729     4191.529 
      24    6.4290895  1000000   896643   277500    7206.0095    4282.5875 
      25    6.6824524  1000000   896647   276240    7150.1275    4366.3882 
      26    6.9361362  1000000   896642   275714    7097.2825    4445.7204 
      27    7.2235754  1000000   896650   275524    7046.2995    4522.2121 
      28    7.4777889  1000000   896651   274728    6997.2155    4595.8536 
      29    7.7324221  1000000   896649   274739    6949.0126    4668.1198 
      30    7.9864969  1000000   896645   273472    6904.7239    4734.6959 
      31    8.2725446  1000000   896637   273639    6864.5696    4794.9237 
      32     8.526103  1000000   896643   273024    6823.8218    4856.0091 
      33    8.7772315  1000000   896643   273922    6783.2508    4916.8569 
      34     9.027905  1000000   896634   271963    6747.5004    4970.4019 
      35     9.313915  1000000   896630   271555    6714.1217    5020.5086 
      36    9.5665171  1000000   896631   271135    6681.6995    5069.2133 
      37    9.8172095  1000000   896631   271664    6651.1999    5114.9489 
      38    10.068566  1000000   896633   270780    6620.8848    5160.4173 
      39    10.353676  1000000   896630   270169    6592.7961    5202.5188 
      40    10.603688  1000000   896633   269174    6565.8547    5242.9629 
      41    10.853956  1000000   896633   269782    6540.1593    5281.5243 
      42    11.105887  1000000   896641   270063    6515.3416    5318.8024 
      43    11.390874  1000000   896630   269529    6491.2197    5355.0018 
      44    11.642554  1000000   896628   269104    6468.2388    5389.5044 
      45    11.894228  1000000   896631   268811    6450.5474    5415.9911 
      46    12.146074  1000000   896628   268870    6430.9755    5445.3156 
      47    12.430713  1000000   896632   268007    6412.2768    5473.4302 
      48    12.682595  1000000   896626   268658    6393.1923    5502.0779 
      49    12.935127  1000000   896632   268020    6376.5395    5527.0692 
      50    13.186983  1000000   896626   267626    6361.3871    5549.8109 
      51    13.470844  1000000   896629   267731    6344.5219    5575.0443 
      52    13.722196  1000000   896624   267210    6329.1438    5598.0784 
      53    13.973131  1000000   896632   266813    6315.0535    5619.2187 
      54    14.224962  1000000   896622   267098    6300.7486     5640.657 
      55    14.508204  1000000   896624   267114    6288.0393    5659.7535 
      56    14.759496  1000000   896633   267329    6276.2377    5677.4236 
      57    15.012059  1000000   896632   267212    6264.6909    5694.7999 
      58    15.263157  1000000   896630   267042    6251.2356    5714.9001 
      59    15.545952  1000000   896628   266409    6240.3873    5731.1645 
      60    15.796975  1000000   896627   266475    6231.1664    5744.9419 
      61    16.047428  1000000   896624   266049    6221.2583    5759.8365 
      62    16.297705  1000000   896625   265756    6212.3059    5773.2534 
      63    16.579832  1000000   896623   266070    6205.0347    5784.1013 
      64    16.830072  1000000   896624   264677    6198.3868    5794.1402 
      65    17.081077  1000000   896629   266727    6191.8351    5803.9507 
      66    17.332158  1000000   896627   266264    6186.3587    5812.0829 
      67     17.61518  1000000   896627   265522    6181.7892    5819.0227 
      68    17.866006  1000000   896631   265847     6173.921    5830.8249 
      69    18.117132  1000000   896626   265620    6165.9927    5842.6702 
      70    18.368073  1000000   896625   266067    6161.0074    5850.1734 
      71    18.649942  1000000   896627   265235    6154.8122    5859.4389 
      72    18.900037  1000000   896628   265417    6150.1236    5866.4395 
      73      19.1495  1000000   896630   265441     6144.919    5874.3579 
      74    19.399745  1000000   896636   266116    6138.0037    5884.7154 
      75    19.681253  1000000   896642   265319    6132.7734    5892.5399 
      76    19.931725  1000000   896638   265619    6129.3139    5897.7495 
      77    20.181685  1000000   896636   265602     6124.114    5905.5467 
      78    20.431663  1000000   896646   265288    6119.7288    5912.1335 
      79    20.713397  1000000   896636   264620    6116.3846    5917.0588 
      80    20.962533  1000000   896633   265214    6112.8787    5922.3102 
      81    21.210825  1000000   896628   265011    6108.0251    5929.6173 
      82    21.459918  1000000   896626   264615    6105.7161    5933.0408 
      83    21.741933  1000000   896626   265467    6101.5093    5939.3131 
      84     21.99037  1000000   896635   264194    6098.6543    5943.6218 
      85    22.238665  1000000   896632   265254    6094.4511    5949.9514 
      86    22.488401  1000000   896631   264545     6091.127    5954.9163 
      87    22.770677  1000000   896629   265148    6087.9891    5959.5863 
      88     23.02134  1000000   896632   265664    6086.2193    5962.2106 
      89    23.270037  1000000   896627   264268    6083.9401    5965.6186 
      90    23.519571  1000000   896621   264945    6081.6345    5969.1053 
      91    23.840511  1000000   896629   264905    6079.3416    5972.5736 
      92    24.089673  1000000   896629   264306    6076.8374    5976.3798 
      93     24.33914  1000000   896628   264660    6074.4804    5979.9361 
      94    24.590599  1000000   896632   264952    6072.0854     5983.478 
      95    24.877654  1000000   896637   264790    6068.9826    5988.1375 
      96    25.128303  1000000   896643   264522    6068.0852    5989.5022 
      97    25.377523  1000000   896643   264726      6066.68    5991.6138 
      98    25.626148  1000000   896639   264609    6065.2918    5993.7204 
      99    25.904392  1000000   896642   264264    6065.6132    5993.2471 
     100    26.152272  1000000   896640   264682    6063.1139    5997.0728 
     101     26.40176  1000000   896641   265021    6061.6712    5999.2298 
     102    26.650503  1000000   896646   264323    6058.8289    6003.4436 
     103    26.934896  1000000   896637   264735    6058.0425    6004.6264 
     104    27.188554  1000000   896643   264287    6056.9485    6006.2776 
     105    27.437941  1000000   896638   264849    6057.1253    6006.0258 
     106     27.68715  1000000   896636   264489    6053.8579    6010.8829 
     107    27.971471  1000000   896638   264123    6054.4404    6010.0046 
     108    28.220828  1000000   896635   264281    6053.9836    6010.6502 
     109    28.470352  1000000   896633   264315     6052.432     6013.046 
     110    28.719142  1000000   896637   264425    6052.2336    6013.3596 
     111    29.003228  1000000   896643   264528    6051.6492    6014.2453 
     112    29.253003  1000000   896634   264446    6050.8561     6015.497 
     113    29.503003  1000000   896634   263901    6050.2782    6016.3467 
     114    29.752392  1000000   896623   265362    6050.1732    6016.5344 
     115    30.035906  1000000   896627   264065    6050.4629    6016.0967 
     116    30.285372  1000000   896624   264627    6048.6324    6018.8533 
     117    30.535788  1000000   896623   265102    6048.9328    6018.4388 
     118    30.786213  1000000   896619   264570    6047.9437    6019.9373 
     119    31.069997  1000000   896629   264532    6048.2348    6019.4773 
     120     31.31967  1000000   896623   264163    6047.8065    6020.0952 
     121    31.570661  1000000   896625   264269    6047.2274    6020.9434 
     122    31.820248  1000000   896628   263469    6046.3871    6022.1737 
     123    32.103969  1000000   896628   264682    6047.5335    6020.3779 
     124    32.354053  1000000   896624   264146    6045.9901    6022.7429 
     125    32.617514  1000000   896626   264361    6046.0688    6022.6348 
     126     32.86748  1000000   896622   265110    6044.4676    6025.0083 
     127    33.152348  1000000   896625   265050    6043.2884    6026.8004 
     128    33.403048  1000000   896629   264188    6043.1405    6027.0664 
     129    33.658747  1000000   896621   264389    6043.3239    6026.7931 
     130    33.924255  1000000   896633   264007    6044.1367    6025.5504 
     131    34.211528  1000000   896626   264319    6043.2426    6026.8994 
     132    34.462338  1000000   896628   263845    6043.7311    6026.1331 
     133    34.712397  1000000   896627   264774    6043.3885    6026.6521 
     134    34.963863  1000000   896631   264598    6042.4833    6028.0121 
     135    35.252345  1000000   896633   264144    6042.5502    6027.8759 
     136    35.502052  1000000   896631   263506    6042.4838    6027.9891 
     137    35.752517  1000000   896636   264901    6041.3693    6029.6549 
     138    36.002127  1000000   896629   264476    6041.4125    6029.5999 
     139    36.284427  1000000   896628   264710     6041.388    6029.6736 
     140    36.535583  1000000   896630   264869    6041.9468      6028.77 
     141    36.785957  1000000   896630   264715    6042.1287    6028.4891 
     142    37.035545  1000000   896629   264522    6041.9688    6028.7797 
     143    37.315087  1000000   896638   264410    6040.9908    6030.2409 
     144     37.56661  1000000   896635   265045    6040.7529     6030.605 
     145     37.81579  1000000   896638   264723     6039.606    6032.3088 
     146    38.065655  1000000   896641   265450    6039.8748    6031.8747 
     147    38.322743  1000000   896630   263781    6040.7104    6030.6395 
     148    38.572604  1000000   896634   264731    6039.7969    6032.0603 
     149    38.821878  1000000   896651   263571    6038.7879    6033.5143 
     150    39.071039  1000000   896637   263667    6036.8148    6036.4332 
     151    39.327432  1000000   896645   264880    6035.2396     6038.821 
     152    39.577978  1000000   896645   264585    6034.9142    6039.2432 
     153    39.827056  1000000   896643   264535    6034.9336    6039.2466 
     154    40.078065  1000000   896643   264053    6035.7273    6038.0772 
     155    40.333203  1000000   896637   264206    6035.0486    6039.0559 
     156    40.583553  1000000   896636   263459     6035.241    6038.8504 
     157     40.83308  1000000   896628   263634    6034.3976    6040.1729 
     158    41.083551  1000000   896634   265165    6035.1579    6038.9893 
     159    41.339347  1000000   896635   264642    6034.4239    6040.1302 
     160    41.590177  1000000   896629   264360    6033.2061    6041.9142 
     161    41.840736  1000000   896627   264990    6033.5211    6041.4485 
     162    42.091107  1000000   896627   264605    6032.8425    6042.5254 
     163    42.365852  1000000   896622   264127    6031.1271    6045.1014 
     164    42.629869  1000000   896623   263865    6032.0412     6043.674 
     165    42.878984  1000000   896628   263457    6031.8587    6043.9347 
     166    43.128652  1000000   896624   264822    6030.0668    6046.5977 
     167    43.411284  1000000   896625   263796    6029.7272    6047.1547 
     168    43.661062  1000000   896629   264334    6031.3784    6044.7093 
     169      43.9094  1000000   896629   263693    6030.9261    6045.3741 
     170    44.158232  1000000   896627   264261    6031.0453     6045.121 
     171    44.440867  1000000   896622   264187    6031.2845    6044.7406 
     172    44.690792  1000000   896625   265112    6031.0867    6045.0044 
     173    44.940169  1000000   896626   263470    6031.3536    6044.6041 
     174    45.189456  1000000   896620   264013    6031.4426    6044.4741 
     175    45.472578  1000000   896625   264781    6029.5635    6047.3206 
     176    45.722981  1000000   896628   264432    6031.0196    6045.1838 
     177    45.972634  1000000   896637   264503    6031.9507    6043.7563 
     178    46.221642  1000000   896630   263946    6032.0071    6043.6911 
     179    46.504742  1000000   896628   265100    6032.1792      6043.46 
     180    46.754635  1000000   896627   263978    6031.0327    6045.1417 
     181    47.004091  1000000   896629   264229    6030.7761    6045.5599 
     182    47.253731  1000000   896630   264224     6030.622    6045.7748 
     183    47.536363  1000000   896622   263300    6032.4748    6042.9452 
     184    47.785913  1000000   896634   264334    6032.3425    6043.1652 
     185    48.034877  1000000   896631   263605    6032.7203    6042.5793 
     186    48.284299  1000000   896639   263594    6032.9167    6042.2912 
     187     48.56731  1000000   896627   264136    6033.8785    6040.9155 
     188    48.816736  1000000   896624   264127    6033.3238    6041.7901 
     189    49.066964  1000000   896628   264155    6035.4252    6038.5704 
     190    49.316211  1000000   896632   263279    6035.7161    6038.1491 
     191    49.599481  1000000   896638   264325    6035.3261    6038.7213 
     192    49.849395  1000000   896635   264759    6036.0498    6037.6506 
     193    50.100741  1000000   896637   264666    6034.8806    6039.4648 
     194    50.349726  1000000   896633   263951    6034.8229    6039.5523 
     195    50.632194  1000000   896632   265266    6035.0698      6039.18 
     196    50.881538  1000000   896633   264427    6036.8311    6036.4757 
     197    51.131377  1000000   896625   264188    6036.2717    6037.3251 
     198    51.382197  1000000   896621   264739    6037.0959    6036.1377 
     199    51.671754  1000000   896624   263731    6037.5481    6035.4221 
     200    51.921428  1000000   896625   263782    6037.2039    6035.9237 
Loop time of 51.9215 on 4 procs for 200 steps with 1000000 particles

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Move    | 3.1388     | 3.5162     | 3.6661     |  11.7 |  6.77
Coll    | 32.738     | 37.571     | 39.758     |  45.9 | 72.36
Sort    | 1.4865     | 1.6502     | 1.7208     |   7.4 |  3.18
Comm    | 1.0479     | 1.0738     | 1.0913     |   1.6 |  2.07
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Output  | 5.6219     | 7.864      | 12.877     | 104.0 | 15.15
Other   |            | 0.2464     |            |       |  0.47

Particle moves    = 200000000 (200M)
Cells touched     = 213215761 (213M)
Particle comms    = 7627772 (7.63M)
Boundary collides = 6607287 (6.61M)
Boundary exits    = 0 (0K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Surf reactions    = 0 (0K)
Collide attempts  = 179326282 (179M)
Collide occurs    = 53652204 (53.7M)
Reactions         = 0 (0K)
Particles stuck   = 0
Axisymm bad moves = 0

Particle-moves/CPUsec/proc: 962992
Particle-moves/step: 1e+06
Cell-touches/particle/step: 1.06608
Particle comm iterations/step: 1
Particle fraction communicated: 0.0381389
Particle fraction colliding with boundary: 0.0330364
Particle fraction exiting boundary: 0
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Surf-reactions/particle/step: 0
Collision-attempts/particle/step: 0.896631
Collisions/particle/step: 0.268261
Reactions/particle/step: 0

Particles: 250000 ave 259313 max 222336 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Cells:      6.75 ave 7 max 6 min
Histogram: 1 0 0 0 0 0 0 0 0 3
GhostCell: 20.25 ave 21 max 20 min
Histogram: 3 0 0 0 0 0 0 0 0 1
EmptyCell: 0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0
