SPARTA (7 Jan 2022)
################################################################################
# thermal gas in a 3d box with collisions
# particles reflect off global box boundaries
#
# Note:
#  - The "comm/sort” option to the “global” command is used to match MPI runs.
#  - The “twopass” option is used to match Kokkos runs.
# The "comm/sort" and "twopass" options should not be used for production runs.
################################################################################

seed	    	    12345
dimension   	    3
global              gridcut 1.0e-5 comm/sort yes

boundary	    rr rr rr

create_box  	    0 0.0001 0 0.0001 0 0.0001
Created orthogonal box = (0 0 0) to (0.0001 0.0001 0.0001)
create_grid 	    3 3 3
WARNING: Could not acquire nearby ghost cells b/c grid partition is not clumped (/ascldap/users/stamoor/sparta_stanmoore1/src/grid.cpp:410)
Created 27 child grid cells
  CPU time = 0.00109625 secs
  create/ghost percent = 84.2975 15.7025

balance_grid        rcb part
Balance grid migrated 24 cells
  CPU time = 0.0008955 secs
  reassign/sort/migrate/ghost percent = 69.2758 0.266241 12.3802 18.0777

species		    n2.species N2
mixture		    air N2 vstream 0.0 0.0 0.0 temp 10000.0 trot 100.0

global              nrho 7.07043E22
global              fnum 7.07043E5

compute             coll_temp_tr thermal/grid all all temp
compute             coll_temp_rot grid all all trot
variable            coll_temp grid (3*c_coll_temp_tr[1]+2*c_coll_temp_rot[1])/5
collide		    vss air n2.vss relax variable T v_coll_temp

create_particles    air n 1000000 twopass
Created 1000000 particles
  CPU time = 0.21229 secs

stats		    1
compute             temp temp
compute             Ttrans reduce ave c_coll_temp_tr[1]

compute             Trot reduce ave c_coll_temp_rot[1]

stats_style	    step cpu np nattempt ncoll c_Ttrans c_Trot

timestep 	    1.00E-9
run 		    200
Memory usage per proc in Mbytes:
  particles (ave,min,max) = 26.1562 23.625 27
  grid      (ave,min,max) = 1.51379 1.51379 1.51379
  surf      (ave,min,max) = 0 0 0
  total     (ave,min,max) = 27.6705 25.1392 28.5142
Step CPU Np Natt Ncoll c_Ttrans c_Trot 
       0            0  1000000        0        0    9994.2537      100.105 
       1   0.71282077  1000000   896600   300365    9779.8376    421.75122 
       2   0.95450234  1000000   896619   298679    9577.7822    724.72828 
       3    1.1957335  1000000   896619   296868     9387.649    1009.8781 
       4     1.437701  1000000   896625   295525    9210.0248    1276.2533 
       5    1.7165065  1000000   896625   293955     9042.374    1527.7554 
       6    1.9566932  1000000   896630   292455    8882.9588    1766.9366 
       7     2.196625  1000000   896628   291417    8733.4492    1991.1643 
       8    2.4371352  1000000   896627   290281     8591.818    2203.6752 
       9    2.7155304  1000000   896630   289419    8456.3384    2406.9849 
      10    2.9548314  1000000   896627   287625    8333.3949    2591.3749 
      11    3.1936018  1000000   896636   286463    8215.0183    2768.8861 
      12    3.4316931  1000000   896636   285977    8102.3794    2937.8308 
      13    3.7084143  1000000   896633   284572    7996.7271    3096.2708 
      14    3.9457784  1000000   896638   283789    7896.4835    3246.6709 
      15    4.1838181  1000000   896639   282976    7801.4046    3389.4073 
      16    4.4210474  1000000   896635   281806    7708.5554    3528.7276 
      17    4.6773455  1000000   896641   281109    7623.3097    3656.6154 
      18    4.9361119  1000000   896638   280098    7545.6118    3773.1351 
      19    5.1723146  1000000   896646   279293    7469.3155    3887.5533 
      20    5.4088433  1000000   896649   278555    7397.9247     3994.624 
      21    5.6465144  1000000   896639   278627    7328.1722    4099.3128 
      22    5.9270949  1000000   896648   277456    7262.0107    4198.5689 
      23    6.1628168  1000000   896645   276962    7198.7106    4293.4893 
      24    6.3976605  1000000   896649   275785    7142.1107    4378.3769 
      25    6.6328602  1000000   896651   275703    7088.4865    4458.8551 
      26    6.9078274  1000000   896649   275419    7036.2221    4537.2407 
      27    7.1425655  1000000   896646   274740     6983.793    4615.8796 
      28    7.3781726  1000000   896642   274074    6935.7236    4687.9454 
      29    7.6130428  1000000   896648   273844    6889.8105    4756.8141 
      30     7.887085  1000000   896645   273051    6847.4559    4820.4002 
      31    8.1210117  1000000   896635   273121     6807.737    4880.0069 
      32    8.3552275  1000000   896647   272575    6769.2438    4937.7238 
      33    8.5898769  1000000   896641   273634     6734.217    4990.3572 
      34    8.8578985  1000000   896643   271403    6699.1641    5042.8935 
      35    9.0913959  1000000   896657   270697    6666.2948    5092.1894 
      36    9.3245313  1000000   896650   270771    6634.6595     5139.613 
      37    9.5580523  1000000   896648   271095    6605.8437    5182.8612 
      38    9.7909012  1000000   896642   269608    6575.5708    5228.1883 
      39    10.056125  1000000   896637   270024    6547.2685    5270.6818 
      40    10.288854  1000000   896634   268915    6521.6757      5309.09 
      41    10.527205  1000000   896634   269330    6499.6364    5342.1977 
      42    10.764514  1000000   896633   269625    6477.9746    5374.6457 
      43    11.010157  1000000   896634   268917    6454.2874     5410.161 
      44    11.242765  1000000   896627   268450    6432.7838    5442.3876 
      45    11.475437  1000000   896632   267886    6413.8817    5470.7196 
      46    11.708287  1000000   896627   268037    6395.5136    5498.3294 
      47    11.951193  1000000   896628   268679     6377.644    5525.1133 
      48    12.183437  1000000   896634   267490     6359.935    5551.6675 
      49    12.416849  1000000   896621   267770    6344.9968     5573.993 
      50    12.649323  1000000   896625   267592    6331.0173     5594.946 
      51    12.882749  1000000   896630   267445    6317.1458    5615.7782 
      52    13.126296  1000000   896632   266963    6303.2447    5636.6266 
      53    13.358527  1000000   896634   266557    6288.7265    5658.3998 
      54    13.590901  1000000   896639   266938    6275.3697    5678.4135 
      55    13.823125  1000000   896631   266673    6263.2421    5696.6551 
      56    14.067352  1000000   896634   266523    6252.8286    5712.3252 
      57    14.299982  1000000   896630   267396     6242.144    5728.3487 
      58    14.533129  1000000   896633   266414    6230.4697    5745.8559 
      59    14.766157  1000000   896627   266666    6221.0581    5760.0095 
      60     15.01196  1000000   896633   266783    6212.5925    5772.7303 
      61    15.258072  1000000   896627   265793    6205.8541    5782.8779 
      62     15.49034  1000000   896630   265762    6197.7638    5794.9959 
      63     15.72311  1000000   896632   265945    6189.4001    5807.4937 
      64    15.956376  1000000   896626   265451    6181.8144    5818.9281 
      65    16.201273  1000000   896624   266217     6174.515    5829.9125 
      66    16.434845  1000000   896630   265651    6165.8085    5842.9949 
      67    16.667804  1000000   896632   265031    6160.5183    5851.0009 
      68    16.901016  1000000   896629   265235    6153.9989    5860.7827 
      69    17.149948  1000000   896633   265588    6147.6487    5870.2645 
      70    17.383033  1000000   896630   265779    6141.6431    5879.2897 
      71    17.614579  1000000   896636   263858     6137.487    5885.4898 
      72    17.847836  1000000   896634   265661    6134.6367    5889.7709 
      73    18.079941  1000000   896636   265416    6128.4176    5899.0692 
      74    18.337217  1000000   896641   265603    6124.3705    5905.0825 
      75    18.569205  1000000   896628   265246    6120.1936    5911.3363 
      76    18.801093  1000000   896632   265157    6116.0563    5917.5212 
      77    19.033561  1000000   896639   265071    6112.8547      5922.37 
      78    19.277719  1000000   896646   265431    6109.2245    5927.8626 
      79     19.50961  1000000   896646   264819    6106.2144    5932.3173 
      80    19.742146  1000000   896643   264553    6101.8046    5939.0325 
      81    20.027033  1000000   896644   265152    6097.8833     5944.967 
      82    20.287852  1000000   896631   264007    6094.1189    5950.5952 
      83     20.58637  1000000   896632   264857    6091.8878    5953.9407 
      84    20.818358  1000000   896629   264758    6089.6035    5957.3915 
      85    21.049699  1000000   896632   264204     6087.585    5960.4254 
      86    21.292495  1000000   896633   264668    6084.5072    5965.0552 
      87    21.524923  1000000   896626   264370    6081.9295    5968.9369 
      88    21.756927  1000000   896631   265264    6078.3763    5974.2823 
      89     21.98888  1000000   896636   264347    6074.9484    5979.4639 
      90    22.220899  1000000   896628   264670    6071.5704    5984.4472 
      91    22.464041  1000000   896630   264570    6069.6375    5987.3516 
      92    22.696349  1000000   896628   264532    6068.1679    5989.5514 
      93    22.927694  1000000   896630   263861    6066.7817    5991.5973 
      94    23.160112  1000000   896635   264595    6064.9297    5994.3547 
      95    23.405246  1000000   896627   264863    6064.8862    5994.5091 
      96     23.63739  1000000   896623   264310    6064.1327    5995.6544 
      97    23.869096  1000000   896628   264806    6062.4764    5998.1156 
      98     24.10013  1000000   896626   263905     6060.674     6000.818 
      99    24.341123  1000000   896630   264126    6060.9157    6000.4475 
     100    24.582897  1000000   896633   264433    6059.9426    6001.9359 
     101    24.815398  1000000   896631   265389    6060.0885    6001.6321 
     102    25.047548  1000000   896628   264318    6057.8049    6005.0693 
     103    25.279252  1000000   896633   264170    6055.8768    6007.9819 
     104    25.522411  1000000   896639   263746    6055.4251    6008.6487 
     105    25.754085  1000000   896636   264790    6053.4468    6011.6433 
     106     25.98516  1000000   896633   263537    6052.4335    6013.1329 
     107     26.21695  1000000   896630   264657    6051.7211    6014.1339 
     108    26.460984  1000000   896636   265066    6051.7905    6014.0125 
     109    26.692302  1000000   896636   264368    6050.0977    6016.6119 
     110    26.923257  1000000   896638   264477    6049.3287     6017.789 
     111    27.154476  1000000   896631   263920    6049.1822    6018.0469 
     112    27.386294  1000000   896629   264392    6048.3567     6019.198 
     113    27.628845  1000000   896628   264460    6048.3607    6019.2739 
     114    27.860852  1000000   896623   265704    6047.2714    6020.8944 
     115    28.092265  1000000   896630   263885    6046.4278    6022.1873 
     116    28.323595  1000000   896622   264467    6045.5785     6023.375 
     117    28.566964  1000000   896624   264914    6044.9568    6024.3314 
     118    28.798574  1000000   896623   264586    6044.7011    6024.6946 
     119    29.030158  1000000   896625   265133    6043.4176    6026.6567 
     120    29.260746  1000000   896625   263651    6042.6795    6027.7517 
     121    29.491877  1000000   896628   264008    6041.9873    6028.8157 
     122    29.741781  1000000   896626   264038    6041.8503    6029.0391 
     123    29.973473  1000000   896631   264312    6041.5237    6029.5156 
     124    30.205294  1000000   896629   264662    6040.0971    6031.6518 
     125    30.436788  1000000   896632   263931    6041.2205    6029.9695 
     126    30.706235  1000000   896632   264047    6041.3973    6029.6833 
     127    30.938097  1000000   896636   264877    6042.3477    6028.2483 
     128    31.169343  1000000   896633   263578    6041.0841     6030.088 
     129    31.400965  1000000   896627   264466    6041.9666    6028.8177 
     130    31.666442  1000000   896625   263717    6040.8409    6030.4941 
     131    31.897325  1000000   896631   264255    6037.8424    6034.9706 
     132    32.128152  1000000   896634   264043    6036.6027    6036.8262 
     133    32.359699  1000000   896622   265142    6036.5639    6036.9262 
     134    32.591048  1000000   896628   265295    6037.3356    6035.6878 
     135    32.862523  1000000   896626   264474    6037.2289    6035.8711 
     136    33.093129  1000000   896620   263436    6036.2166    6037.3993 
     137    33.324026  1000000   896623   264354    6035.8549    6037.9338 
     138    33.555287  1000000   896618   264341    6036.6167    6036.7444 
     139    33.827539  1000000   896630   264280    6036.9327     6036.339 
     140    34.059591  1000000   896621   264334    6037.2626    6035.8549 
     141     34.29121  1000000   896626   264008    6038.5343    6033.9456 
     142    34.522968  1000000   896629   264775    6037.9863    6034.7305 
     143    34.794954  1000000   896636   264384     6037.477    6035.5143 
     144    35.027522  1000000   896629   264965    6038.2308    6034.3844 
     145    35.259694  1000000   896631   264766    6037.3179    6035.7765 
     146    35.492215  1000000   896627   265003    6038.2109    6034.4189 
     147    35.753207  1000000   896630   264095    6037.9671    6034.7286 
     148     35.98598  1000000   896631   264903    6038.2393    6034.3352 
     149    36.217765  1000000   896636   263360    6038.5672    6033.8501 
     150    36.449737  1000000   896633   263590    6038.7623    6033.5754 
     151    36.682131  1000000   896631   265318    6037.8873    6034.9086 
     152    36.955469  1000000   896641   264400    6039.5109    6032.4747 
     153    37.187428  1000000   896646   264397    6039.8057    6032.0262 
     154    37.419262  1000000   896637   264219     6040.695    6030.7214 
     155    37.651145  1000000   896640   264692     6040.548    6030.9425 
     156    37.923882  1000000   896641   264394    6041.1526    6030.0538 
     157    38.155613  1000000   896641   263683    6040.3402    6031.2952 
     158     38.38921  1000000   896637   265303    6039.7025    6032.1946 
     159    38.621443  1000000   896637   264699    6039.1689    6032.9659 
     160    38.894061  1000000   896639   264141    6039.7906     6031.985 
     161    39.126795  1000000   896641   264989    6039.1518    6032.9522 
     162     39.35907  1000000   896641   264375    6038.4216    6034.0806 
     163    39.591255  1000000   896649   264452    6038.9453    6033.3063 
     164    39.833483  1000000   896641   264192    6038.8952    6033.3438 
     165    40.099047  1000000   896652   263742    6040.0076    6031.7276 
     166    40.331233  1000000   896643   264690    6039.6113    6032.3349 
     167    40.563571  1000000   896645   263851    6039.0399    6033.2478 
     168    40.803455  1000000   896642   264111    6041.2874    6029.8345 
     169    41.075942  1000000   896640   264191    6042.4337    6028.1303 
     170    41.308694  1000000   896639   264729    6042.9748    6027.3427 
     171    41.541151  1000000   896640   264469    6041.5683    6029.4947 
     172    41.773962  1000000   896640   264058     6040.661    6030.8343 
     173    42.046766  1000000   896644   264109    6041.7395    6029.2121 
     174    42.278946  1000000   896642   264368    6040.1644    6031.6012 
     175    42.511542  1000000   896638   265073    6039.7073    6032.2248 
     176    42.743516  1000000   896643   263685    6039.1393    6033.1469 
     177    43.014664  1000000   896640   265233    6040.3753    6031.2337 
     178    43.246007  1000000   896638   263384    6041.1304    6030.0962 
     179    43.477969  1000000   896631   264829    6040.6751    6030.8084 
     180     43.70982  1000000   896646   264262    6041.4223    6029.7135 
     181    43.942088  1000000   896639   264375    6042.2361    6028.4719 
     182    44.213588  1000000   896640   264601    6042.7427    6027.7092 
     183    44.445478  1000000   896646   264430     6043.493    6026.5466 
     184    44.676915  1000000   896656   264463    6041.6662    6029.2671 
     185    44.908332  1000000   896655   264228     6041.395    6029.6177 
     186    45.174749  1000000   896648   264149    6041.4991    6029.4653 
     187    45.406553  1000000   896653   264010    6041.7245    6029.1249 
     188     45.63833  1000000   896649   264365    6041.4275    6029.4861 
     189    45.887189  1000000   896647   264521    6040.6068    6030.7197 
     190    46.157474  1000000   896639   263121    6040.3786    6031.0558 
     191    46.388934  1000000   896637   264018    6039.8899    6031.6985 
     192    46.620304  1000000   896636   265050    6041.7371    6028.8885 
     193     46.85149  1000000   896635   264242    6040.6455    6030.5292 
     194    47.111107  1000000   896639   264822    6041.5716    6029.0771 
     195    47.361383  1000000   896634   264859    6040.2362    6031.0952 
     196    47.592347  1000000   896633   264165    6040.7818    6030.3024 
     197    47.823498  1000000   896639   264346    6039.2747     6032.684 
     198    48.055009  1000000   896640   264901    6039.9471    6031.6727 
     199    48.326751  1000000   896635   264311    6039.3204    6032.6064 
     200    48.558475  1000000   896634   264125    6038.2188    6034.3266 
Loop time of 48.5586 on 4 procs for 200 steps with 1000000 particles

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Move    | 3.1741     | 3.508      | 3.6495     |  10.3 |  7.22
Coll    | 31.049     | 34.861     | 36.599     |  37.6 | 71.79
Sort    | 1.5422     | 1.6642     | 1.7121     |   5.5 |  3.43
Comm    | 1.0594     | 1.076      | 1.0857     |   1.0 |  2.22
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Output  | 5.4277     | 7.2252     | 11.169     |  85.4 | 14.88
Other   |            | 0.2236     |            |       |  0.46

Particle moves    = 200000000 (200M)
Cells touched     = 213196805 (213M)
Particle comms    = 7622069 (7.62M)
Boundary collides = 6598321 (6.6M)
Boundary exits    = 0 (0K)
SurfColl checks   = 0 (0K)
SurfColl occurs   = 0 (0K)
Surf reactions    = 0 (0K)
Collide attempts  = 179326940 (179M)
Collide occurs    = 53616639 (53.6M)
Reactions         = 0 (0K)
Particles stuck   = 0
Axisymm bad moves = 0

Particle-moves/CPUsec/proc: 1.02968e+06
Particle-moves/step: 1e+06
Cell-touches/particle/step: 1.06598
Particle comm iterations/step: 1
Particle fraction communicated: 0.0381103
Particle fraction colliding with boundary: 0.0329916
Particle fraction exiting boundary: 0
Surface-checks/particle/step: 0
Surface-collisions/particle/step: 0
Surf-reactions/particle/step: 0
Collision-attempts/particle/step: 0.896635
Collisions/particle/step: 0.268083
Reactions/particle/step: 0

Particles: 250000 ave 259883 max 222431 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Cells:      6.75 ave 7 max 6 min
Histogram: 1 0 0 0 0 0 0 0 0 3
GhostCell: 20.25 ave 21 max 20 min
Histogram: 3 0 0 0 0 0 0 0 0 1
EmptyCell: 0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0
