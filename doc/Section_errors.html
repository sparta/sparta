<HTML>
<CENTER><A HREF = "Section_python.html">Previous Section</A> - <A HREF = "http://dsmc.sandia.gov">DSMC WWW Site</A> -
<A HREF = "Manual.html">DSMC Documentation</A> - <A HREF = "Section_commands.html#comm">DSMC Commands</A> - <A HREF = "Section_history.html">Next
Section</A> 
</CENTER>






<HR>

<H3>12. Errors 
</H3>
<P>This section describes the various kinds of errors you can encounter
when using DSMC.
</P>
12.1 <A HREF = "#err_1">Common problems</A><BR>
12.2 <A HREF = "#err_2">Reporting bugs</A><BR>
12.3 <A HREF = "#err_3">Error & warning messages</A> <BR>

<HR>

<A NAME = "err_1"></A><H4>12.1 Common problems 
</H4>
<P>If two DSMC runs do not produce the same answer on different
machines or different numbers of processors, this is typically not a
bug.  In theory you should get identical answers on any number of
processors and on any machine.  In practice, numerical round-off can
cause slight differences and eventual divergence of molecular dynamics
phase space trajectories within a few 100s or few 1000s of timesteps.
However, the statistical properties of the two runs (e.g. average
energy or temperature) should still be the same.
</P>
<P>If the <A HREF = "velocity.html">velocity</A> command is used to set initial atom
velocities, a particular atom can be assigned a different velocity
when the problem is run on a different number of processors or on
different machines.  If this happens, the phase space trajectories of
the two simulations will rapidly diverge.  See the discussion of the
<I>loop</I> option in the <A HREF = "velocity.html">velocity</A> command for details and
options that avoid this issue.
</P>
<P>Similarly, the <A HREF = "create_atoms.html">create_atoms</A> command generates a
lattice of atoms.  For the same physical system, the ordering and
numbering of atoms by atom ID may be different depending on the number
of processors.
</P>
<P>Some commands use random number generators which may be setup to
produce different random number streams on each processor and hence
will produce different effects when run on different numbers of
processors.  A commonly-used example is the <A HREF = "fix_langevin.html">fix
langevin</A> command for thermostatting.
</P>
<P>A DSMC simulation typically has two stages, setup and run.  Most
DSMC errors are detected at setup time; others like a bond
stretching too far may not occur until the middle of a run.
</P>
<P>DSMC tries to flag errors and print informative error messages so
you can fix the problem.  Of course, DSMC cannot figure out your
physics or numerical mistakes, like choosing too big a timestep,
specifying erroneous force field coefficients, or putting 2 atoms on
top of each other!  If you run into errors that DSMC doesn't catch
that you think it should flag, please send an email to the
<A HREF = "http://dsmc.sandia.gov/authors.html">developers</A>.
</P>
<P>If you get an error message about an invalid command in your input
script, you can determine what command is causing the problem by
looking in the log.lammps file or using the <A HREF = "echo.html">echo command</A>
to see it on the screen.  For a given command, DSMC expects certain
arguments in a specified order.  If you mess this up, DSMC will
often flag the error, but it may read a bogus argument and assign a
value that is valid, but not what you wanted.  E.g. trying to read the
string "abc" as an integer value and assigning the associated variable
a value of 0.
</P>
<P>Generally, DSMC will print a message to the screen and logfile and
exit gracefully when it encounters a fatal error.  Sometimes it will
print a WARNING to the screen and logfile and continue on; you can
decide if the WARNING is important or not.  A WARNING message that is
generated in the middle of a run is only printed to the screen, not to
the logfile, to avoid cluttering up thermodynamic output.  If DSMC
crashes or hangs without spitting out an error message first then it
could be a bug (see <A HREF = "#err_2">this section</A>) or one of the following
cases:
</P>
<P>DSMC runs in the available memory a processor allows to be
allocated.  Most reasonable MD runs are compute limited, not memory
limited, so this shouldn't be a bottleneck on most platforms.  Almost
all large memory allocations in the code are done via C-style malloc's
which will generate an error message if you run out of memory.
Smaller chunks of memory are allocated via C++ "new" statements.  If
you are unlucky you could run out of memory just when one of these
small requests is made, in which case the code will crash or hang (in
parallel), since DSMC doesn't trap on those errors.
</P>
<P>Illegal arithmetic can cause DSMC to run slow or crash.  This is
typically due to invalid physics and numerics that your simulation is
computing.  If you see wild thermodynamic values or NaN values in your
DSMC output, something is wrong with your simulation.  If you
suspect this is happening, it is a good idea to print out
thermodynamic info frequently (e.g. every timestep) via the
<A HREF = "thermo.html">thermo</A> so you can monitor what is happening.
Visualizing the atom movement is also a good idea to insure your model
is behaving as you expect.
</P>
<P>In parallel, one way DSMC can hang is due to how different MPI
implementations handle buffering of messages.  If the code hangs
without an error message, it may be that you need to specify an MPI
setting or two (usually via an environment variable) to enable
buffering or boost the sizes of messages that can be buffered.
</P>
<HR>

<A NAME = "err_2"></A><H4>12.2 Reporting bugs 
</H4>
<P>If you are confident that you have found a bug in DSMC, follow these
steps.
</P>
<P>Check the <A HREF = "http://dsmc.sandia.gov/bug.html">New features and bug
fixes</A> section of the <A HREF = "http://dsmc.sandia.gov">DSMC WWW
site</A> to see if the bug has already been reported or fixed or the
<A HREF = "http://dsmc.sandia.gov/unbug.html">Unfixed bug</A> to see if a fix is
pending.
</P>
<P>Check the <A HREF = "http://dsmc.sandia.gov/mail.html">mailing list</A>
to see if it has been discussed before.
</P>
<P>If not, send an email to the mailing list describing the problem with
any ideas you have as to what is causing it or where in the code the
problem might be.  The developers will ask for more info if needed,
such as an input script or data files.
</P>
<P>The most useful thing you can do to help us fix the bug is to isolate
the problem.  Run it on the smallest number of atoms and fewest number
of processors and with the simplest input script that reproduces the
bug and try to identify what command or combination of commands is
causing the problem.
</P>
<P>As a last resort, you can send an email directly to the
<A HREF = "http://dsmc.sandia.gov/authors.html">developers</A>.
</P>
<HR>

<H4><A NAME = "err_3"></A>12.3 Error & warning messages 
</H4>
<P>These are two alphabetic lists of the <A HREF = "#error">ERROR</A> and
<A HREF = "#warn">WARNING</A> messages DSMC prints out and the reason why.  If the
explanation here is not sufficient, the documentation for the
offending command may help.  
Error and warning messages also list the source file and line number
where the error was generated.  For example, this message
</P>
<P>ERROR: Illegal velocity command (velocity.cpp:78)
</P>
<P>means that line #78 in the file src/velocity.cpp generated the error.
Looking in the source code may help you figure out what went wrong.
</P>
<P>Note that error messages from <A HREF = "Section_start.html#start_3">user-contributed
packages</A> are not listed here.  If such an
error occurs and is not self-explanatory, you'll need to look in the
source code or contact the author of the package.
</P>
<H4><A NAME = "error"></A>Errors: 
</H4>
<DL>

<DT><I>1-3 bond count is inconsistent</I> 

<DD>An inconsistency was detected when computing the number of 1-3
neighbors for each atom.  This likely means something is wrong with
the bond topologies you have defined. 

<DT><I>Zero-length lattice orient vector</I> 

<DD>Self-explanatory. 


</DL>
<H4><A NAME = "warn"></A>Warnings: 
</H4>
<DL>

<DT><I>All element names have been set to 'C' for dump cfg</I> 

<DD>Use the dump_modify command if you wish to override this. 

<DT><I>Using pair tail corrections with nonperiodic system</I> 

<DD>This is probably a bogus thing to do, since tail corrections are
computed by integrating the density of a periodic system out to
infinity. 


</DL>
</HTML>
