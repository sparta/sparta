"SPARTA WWW Site"_sws - "SPARTA Documentation"_sd - "SPARTA Commands"_sc :c

:link(sws,https://sparta.github.io)
:link(sd,Manual.html)
:link(sc,Section_commands.html#comm)

:line

compute vmom/grid command :h3

[Syntax:]

compute ID vmom/grid group-ID mix-ID value1 value2 ... :pre

ID is documented in "compute"_compute.html command :ulb,l
vmom/grid = style name of this compute command :l
group-ID = group ID for which grid cells to perform calculation on :l
mix-ID = mixture ID to perform calculation on :l
one or more values can be appended :l
value = {v2} or {vx3} or {vy3} or {vz3} or {v4} :l
  {v2} = second velocity moment
  {vx3} or {vy3} or {vz3} = third velocity moment in the x,y,z direction
  {v4} = fourth velocity moment :pre
:ule

[Examples:]

compute 1 vmom/grid all air v2
compute 1 thermal/grid subset species vx3 v4 :pre

These commands will dump time averaged velocity moments for
each species and each grid cell to a dump file every 1000 steps:

compute 1 vmom/grid species v4
fix 1 ave/grid 10 100 1000 c_1\[*\]
dump 1 grid all 1000 tmp.vmom id f_1\[*\] :pre

[Description:]

Define a computation that calculates one or more values for each grid
cell in a grid cell group, which are based on the particle velocities.
The values are tallied separately for each group of species in the
specified mixture, as described in
the Output section below.  See the mixture command for how a set of
species can be partitioned into groups.

Only grid cells in the grid group specified by {group-ID} are included
in the calculation.  See the "group grid"_group.html command for info
on how grid cells can be assigned to grid groups.

The results of this compute can be used by different commands in
different ways.  The values for a single timestep can be output by the
"dump grid"_dump.html command.

The values over many sampling timesteps can be averaged by the "fix
ave/grid"_fix_ave_grid.html command.  It does its averaging as if the
particles in the cell at each sampling timestep were combined together
into one large set of particles to compute the formulas below.  

Note that this is a different form of averaging than taking the values
produced by the formulas below for a single timestep, summing those
values over the sampling timesteps, and then dividing by the number of
sampling steps.

:line

Calculation of the velocity moment is an ensemble average of the velocities
of all particles in the cell. Formulas for each moment is shown below:

Vsq_i = Vx_i*Vx_i + Vy_i*Vy_i + Vz_i*Vz_i
<v^2> = Sum_i (mass_i Vsq_i) / Sum_i (mass_i)
<v^3>_x = Sum_i (mass_i * Vx_i * Vsq_i) / Sum_i (mass_i)
<v^3>_y = Sum_i (mass_i * Vy_i * Vsq_i) / Sum_i (mass_i)
<v^3>_z = Sum_i (mass_i * Vz_i * Vsq_i) / Sum_i (mass_i)
<v^4> = Sum_i (mass_i * Vx_i * Vx_i * Vx_i * Vx_i) / Sum_i (mass_i) :pre

The velocity of particle "i" is (Vx_i,Vy_i,Vz_i), and the mass of particle "i"
is mass_i. Notice that <v^4> is measured only from x-velocity components.

:line

[Output info:]

This compute calculates a per-grid array, with the number of columns
equal to the number of values times the number of groups.  The
ordering of columns is first by values, then by groups.  I.e. if the
{temp} and {press} values were specified as keywords, then the first
two columns would be {temp} and {press} for the first group, the 3rd
and 4th columns would be {temp} and {press} for the second group, etc.

This compute performs calculations for all flavors of child grid cells
in the simulation, which includes unsplit, cut, split, and sub cells.
See "Section 6.8"_Section_howto.html#howto_8 of the manual gives
details of how SPARTA defines child, unsplit, split, and sub cells.
Note that cells inside closed surfaces contain no particles.  These
could be unsplit or cut cells (if they have zero flow volume).  Both
of these kinds of cells will compute a zero result for all their
values.  Likewise, split cells store no particles and will produce a
zero result.  This is because their sub-cells actually contain the
particles that are geometrically inside the split cell.

Grid cells not in the specified {group-ID} will output zeroes for all
their values.

The array can be accessed by any command that uses per-grid values
from a compute as input.  See "Section 6.4"_Section_howto.html#howto_4
for an overview of SPARTA output options.

The per-grid array values will be in the "units"_units.html
appropriate to the individual values as described above.  {v2} is in
velocity^2 units.  {v3x}, {vy3}, and {vz3} is in velocity^3 units.
{v4} is in velocity^4 units.

:line

[Restrictions:] none

[Related commands:]

"compute grid"_compute_grid.txt, "fix ave/grid"_fix_ave_grid.html,
"dump grid"_dump.html

[Default:] none
