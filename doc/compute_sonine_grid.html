<HTML>
<CENTER><A HREF = "http://dsmc.sandia.gov">SPARTA WWW Site</A> - <A HREF = "Manual.html">SPARTA Documentation</A> - <A HREF = "Section_commands.html#comm">SPARTA Commands</A> 
</CENTER>






<HR>

<H3>compute sonine/grid command 
</H3>
<P><B>Syntax:</B>
</P>
<PRE>compute ID sonine/grid mix-ID keyword values ... 
</PRE>
<UL><LI>ID is documented in <A HREF = "compute.html">compute</A> command 

<LI>sonine/grid = style name of this compute command 

<LI>mix-ID = mixture ID to perform calculation on 

<LI>one or more keywords may be appended, multiple times 

<LI>keyword = <I>thermal</I> or <I>a</I> or <I>b</I> 

<LI>values = values for specific keyword 

<PRE>  <I>thermal</I> args = none = thermal temperature
  <I>a</I> args = dim order = sonine A moment
    dim = <I>x</I> or <I>y</I> or <I>z</I>
    order = number from 1 to 5
  <I>b</I> args = dim2 order = sonine B moment
    dim2 = <I>xx</I> or <I>yy</I> or <I>zz</I> or <I>xy</I> or <I>yz</I> or <I>xz</I>
    order = number from 1 to 5 
</PRE>

</UL>
<P><B>Examples:</B>
</P>
<PRE>compute 1 sonine/grid species thermal a x 3 a z 3 b xy 3 b xz 3
compute 1 sonine/grid air a x 5 b xy 5 
</PRE>
<P>These commands will dump 10 averaged sonine moments for each species
and each grid cell to a file every 1000 steps:
</P>
<PRE>compute 1 sonine/grid species a x 5 b xy 5
fix 1 ave/grid 10 100 1000 c_1
dump 1 grid 1000 tmp.grid id f_1 
</PRE>
<P><B>Description:</B>
</P>
<P>Define a computation that calculates the sonine moments of the
velocity distribution of the molecules in each grid cell.  The moments
are summed for each group of species in the specified mixture.  See
the <A HREF = "mixture.html">mixture</A> command for how a set of species can be
partitioned into groups.
</P>
<P>The results of this compute are used by different commands in
different ways.  The values for a single timestep can be output by the
<A HREF = "dump.html">dump grid</A> command.  The values over many timesteps or the
entire simulation can be averaged together by the <A HREF = "fix_ave_grid.html">fix
ave/grid</A> command.  In this case, it is as if the
formulas below are sums over both molecules in the grid cell and over
time, with the normalizing factor in the denominator also being summed
over time.
</P>
<HR>

<P>The <I>thermal</I> keyword computes the average thermal kinetic energy for
all <I>N</I> molecules in the group.  This is converted to a temperature
<I>T</I> by the following formula where <I>kB</I> is the Boltzmann factor:
</P>
<PRE>COMx = Sum_i (mass_i Vx_i) / Sum_i (mass_i)
COMy = Sum_i (mass_i Vy_i) / Sum_i (mass_i)
COMz = Sum_i (mass_i Vz_i) / Sum_i (mass_i)
Cx = Vx - COMx
Cy = Vy - COMy
Cz = Vz - COMz
Csq = Cx*Cx + Cy*Cy + Cz*Cz
thermal_KE = Sum_i (1/2 mass_i Csq_i) / N
T = thermal_KE / (3/2 kB) 
</PRE>
<P>Note that the thermal kinetic energy is calculated from <I>C</I> = the
thermal velocity of each molecule, which is its velocity minus the
center-of-mass (COM) velocity of molecules in the group.  The COM
velocity is the mass-weighted sum of the velocities of molecules in
the group divided by the total mass of the molecules.
</P>
<HR>

<P>The <I>a</I> keyword calculates the aveage of one or more sonine A moments
for all molecules in the group:
</P>
<PRE>A1 = Sum_i (mass_i * Vdim * pow(Csq,1)) / Sum_i (mass_i)
A2 = Sum_i (mass_i * Vdim * pow(Csq,2)) / Sum_i (mass_i)
A3 = Sum_i (mass_i * Vdim * pow(Csq,3)) / Sum_i (mass_i)
A4 = Sum_i (mass_i * Vdim * pow(Csq,4)) / Sum_i (mass_i)
A5 = Sum_i (mass_i * Vdim * pow(Csq,5)) / Sum_i (mass_i) 
</PRE>
<P>Vdim is Vx or Vy or Vz as specified by the <I>dim</I> value.  <I>Csq</I> is the
squared thermal velocity of the molecule, as in the <I>thermal</I>
equations above.  The number of moments computed is specified by the
<I>order</I> value.
</P>
<P>The <I>b</I> keyword calculates the averageof one or more sonine B moments
for all molecules in the group:
</P>
<PRE>B1 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,1)) / Sum_i (mass_i)
B2 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,2)) / Sum_i (mass_i)
B3 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,3)) / Sum_i (mass_i)
B4 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,4)) / Sum_i (mass_i)
B5 = Sum_i (mass_i * Vdim1 * Vdim2 * pow(Csq,5)) / Sum_i (mass_i) 
</PRE>
<P>Vdim is Vx or Vy or Vz as specified by the <I>dim</I> value.  <I>Csq</I> is the
squared thermal velocity of the molecule, as in the <I>thermal</I>
equations above.  The number of moments computed is specified by the
<I>order</I> value.
</P>
<HR>

<P><B>Output info:</B>
</P>
<P>This compute calculates a per-grid array, with the number of columns
is equal to the number of values times the number of groups.  The
ordering of columns is first by values, then by groups.  I.e. if the
<I>thermal</I> and <I>b xy 2</I> moments were specified as keywords, then the
1st thru 3rd columns would be the <I>thermal</I> and B1 and B2 moments of
the first group, the 4th thru 6th columns would be the <I>thermal</I> and
B1 and B2 moments of the second group, etc.
</P>
<P>The array can be accessed by any command that uses per-grid values
from a compute as input.
</P>
<P>The per-grid array values will be in the <A HREF = "units.html">units</A>
appropriate to the individual values as described above.  <I>Thermal</I> is
in temperature units.  A and B are in units like velocity cubed or
velocity to the 6th power.
</P>
<P><B>Restrictions:</B> none
</P>
<P><B>Related commands:</B>
</P>
<P><A HREF = "fix_ave_grid.html">fix ave/grid</A>, <A HREF = "dump.html">dump grid</A>
</P>
<P><B>Default:</B> none
</P>
</HTML>
